# 巧转拼图（RotaPuzzle）游戏开发迭代计划

## 第1阶段：核心游戏机制

### 目标：
1. 创建基本的游戏界面
2. 实现碎片拖拽系统
3. 实现碎片旋转系统
4. 实现基本的碎片与目标形状匹配检测
5. 实现随机生成的碎片形状
6. 实现多语言支持

### 分工：

Recoh需要准备的内容：(查看prototype目录)
- 具体的游戏界面布局设计（html原型）
  - [x] 1. 游戏加载页(loading.html)
  - [x] 2. 游戏初始页(Initial.html)
  - [x] 3. How To Play 界面（how to play.html）
  - [x] 4. 游戏暂停界面(pause.html)
  - [x] 5. 关卡欢迎页（level-welcome.html）
  - [x] 6. Play页面
  - [x] 7. 游戏关卡完成界面（level-complete.html）
  - [x] 8. 游戏完成界面
  - [x] 9. 游戏设置界面

Cursor将协助完成的部分：
- 碎片和目标形状的具体表现形式
  1. 使用SVG绘制
  2. 实现随机生成的多边形或不规则形状（含曲线图形）算法
  3. 实现难度递增的碎片生成机制
  
- 拖拽和旋转的具体交互方式
  1. 在PC端使用浏览器时支持鼠标事件
  2. 在手机端使用浏览器时支持触摸事件
  3. 使用interact.js库统一处理鼠标和触摸事件
  4. 实现多点触控支持，允许同时操作多个碎片
  5. 添加视觉和听觉反馈以增强用户体验

- 碎片与目标形状匹配检测的具体算法
  1. 定义匹配阈值（如重叠面积百分比）
  2. 实现简单的重叠面积计算方法
  3. 考虑旋转角度的误差允许范围

### 实现建议：

1. 响应式设计：
   - 使用CSS媒体查询来适应不同的屏幕尺寸（游戏界面自适应1024X768和1920X1080比例屏幕，需要考虑移动终端浏览器游戏界面自适应显示。）
   - 采用弹性布局（Flexbox）或网格布局（Grid）来实现自适应界面
   - 使用相对单位（如vw, vh, rem）代替固定像素值
   - 为移动设备优化触摸交互 

2. 碎片生成算法：
   - 根据难度级别生成不同类型的碎片
   - 初级：使用预定义的规则几何图形模板
   - 中级：使用多边形生成算法创建不规则图形
   - 高级：结合贝塞尔曲线算法生成包含曲线的不规则图形
   - 使用SVG路径和贝塞尔曲线生成不规则形状
   - 确保生成的碎片大小合理，能够组合成目标图形
 补充：
   - 初级：所有碎片均由规则几何图形组成，包括：正方形、长方形、正三角形、45度直角三角形、30度和60度直角三角形
   - 中级：所有碎片均使用不规则几何图形，包括初级里面的规则几何图形，但不含由曲线生成的不规则图形。
   - 高级：所有碎片均使用不规则图形，包括由曲线生成的不规则图形，不含初级的规则几何图形。

3. 界面设计：
   - 采用2D扁平化设计风格
   - 使用莫兰迪色系作为主要配色方案
   - 参考[Flat Design Colors](https://laochao.github.io/Colors/flat.html)中的配色方案，选择柔和的色调

4. 拖拽和旋转功能的视觉和听觉反馈：
   - 添加轻微的阴影或发光效果，指示当前选中的碎片
   - 实现碎片拖动时的平滑动画效果
   - 添加轻微的音效，如拾取、放下和旋转碎片时的声音
   - 当碎片接近正确位置时，提供视觉提示（如微小的吸附效果）

5. 难度递增机制：
   - 初始关卡使用3块简单形状的碎片
   - 随着玩家进度，逐步增加碎片数量和复杂度
   - 在高级关卡中引入更复杂的曲线和不规则形状

6. 性能优化：
   - 使用SVG而不是Canvas来绘制碎片，以确保在不同分辨率下的清晰度
   - 使用requestAnimationFrame来优化动画性能
   - 实现碎片的延迟加载，以提高初始加载速度

7. 碎片互动效果：
  - 触发碎片时增加边缘发光效果，可以通过CSS的box-shadow属性实现[^1]
   - 添加轻微的旋转效果，增加交互感[^1]
   - 当碎片被拖起时，添加阴影效果来模拟立体感[^1]
   - 在拾取、放下和旋转碎片时添加轻微的音效，增强用户体验[^1]
   - 当碎片接近正确位置时，添加轻微的吸附效果，给用户视觉提示[^1]
   - 在鼠标悬停或选中碎片时稍微放大碎片，突出当前操作的部分[^1]
   [^1]: https://pixso.cn/designskills/youxijiemiansj/

8.后台设置页面：
   - 创建一个新的设置界面，包含关卡数和难度设置选项
   - 实现关卡数的输入验证，确保不超过20关
   - 创建难度选择的下拉菜单或单选按钮组
   - 将设置保存到本地存储或服务器，以便在游戏启动时加载


## 第2阶段：关卡系统和计分

### 目标：
1. 实现单个关卡的完整流程
2. 开发基于难度系数的动态计分系统
3. 添加关卡切换机制
4. 实现基本的用户界面（UI）元素（如顶部信息栏、底部控制栏）

### 需要补充的内容：
- 实现动态难度系数计算
- 设计并实现基于难度和关卡数的计分公式
- 关卡切换时的具体流程和可能的过渡效果
- UI元素的详细设计（包括布局、颜色方案等）

## 第3阶段：随机关卡生成和难度递增

### 目标：
1. 开发随机关卡生成系统
2. 实现难度递增机制
3. 完善计分系统，考虑难度因素和关卡数量

### 需要补充的内容：
- 随机关卡生成算法的具体描述或伪代码
- 难度递增的具体参数和规则（如每个难度级别的具体特征）
- 确保计分系统能够适应4-20个关卡的设置

## 第4阶段：提示系统和游戏流程完善

### 目标：
1. 实现提示系统
2. 添加暂停功能和相关界面
3. 完善游戏流程（包括开始、结束等）
4. 实现本地存储功能（保存进度和设置）

### 需要补充的内容：
- 提示系统的具体实现方式和视觉效果
- 暂停界面的详细设计
- 游戏开始和结束时的具体流程和可能的动画效果
- 需要保存的具体数据项和存储方式

## 第5阶段：音效、动画和性能优化

### 目标：
1. 添加背景音乐和音效
2. 实现各种动画效果（如碎片状态变化、关卡切换等）
3. 进行性能优化
4. 实现响应式设计

### 需要补充的内容：
- 具体的音效列表和触发条件
- 动画效果的详细描述（如持续时间、缓动函数等）
- 性能优化的具体目标和测试标准
- 响应式设计的具体要求和断点

## 第6阶段：附加功能和最终polish

### 目标：
1. 实现分数榜单系统
2. 添加游戏说明/教程
3. 实现可访问性功能
4. 进行跨浏览器和跨设备测试
5. 最终调整和polish

### 需要补充的内容：
- 分数榜单的具体设计和显示方式
- 游戏说明/教程的内容和呈现方式
- 可访问性功能的具体要求和实现方式
- 测试计划，包括目标浏览器和设备列表
- 任何最终的视觉或游戏性调整需求